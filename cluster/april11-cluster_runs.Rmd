---
title: "uhat=10% and uhat=5% cluster runs with debugged scripts and 10 gens until drive"
author: "Isabel Kim"
date: "4/11/2022"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## uhat=10% jobs

### Planning

* Before, a_observed was 0.0108 and a_predicted was 0.0041
```{r}
library(tidyverse)
source("/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/scripts/auc-equations.R")

sigma = 0.01
k = 0.2
uhat = 0.1

n = 101
a_vector = seq(0, 0.02, length.out=n)
delta_vector = rep(-1,n)

for (i in 1:n){
  delta_vector[i] = factored_delta(a_vector[i],1,sigma,k,uhat)
}


results = tibble(a=a_vector, delta = delta_vector)
p = ggplot(results, aes(x=a,y=delta)) + geom_point(color = "red") + geom_line() + geom_hline(yintercept = 0)

print(p)

# Find x-intercept
a_not_zero = a_vector[2:n]
delta_not_zero = delta_vector[2:n]
ind = which.min(abs(delta_not_zero))
a_star = a_not_zero[ind]
delta_star = delta_not_zero[ind]
print(paste("Delta is",delta_star,"at a=",a_star))
```

Predicted a is around 0.0042.

* Let's do a 100-length vector from 0.001 to 0.02, then a 50-length vector from 0.02 to 1.0
```{r}
a_seq = c(seq(0.001,0.02,length.out=100),seq(0.03,1.0,length=50))
```

### Files:

* text file: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.1_run/slurm_text/uhat10_april11_full_a_run.txt`
* SLURM main script: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.1_run/slurm_main/uhat10_april11_main.sh`
  + **Submitted batch job 4277244**
* SLURM merge script: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.1_run/slurm_merge/uhat10_april11_merge.sh`
  + On the cluster, this is at: `/home/ikk23/underdom/merge_scripts/uhat10_april11_merge.sh`
    * This will create `/home/ikk23/underdom/csvs/uhat10_april11_full_a_run.csv` on the cluster
* Csv raw is now at: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.1_run/csv_raw/uhat10_april11_full_a_run.csv`
* Summary csv file is now at: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.1_run/csvs/summary_april11_full_range_uhat10.csv`

## uhat=5% jobs

### Planning

* Before, a_predicted was 0.002 and a_observed was 0.005
```{r}
sigma = 0.01
k = 0.2
uhat = 0.05

n = 101
a_vector = seq(0, 0.005, length.out=n)
delta_vector = rep(-1,n)

for (i in 1:n){
  delta_vector[i] = factored_delta(a_vector[i],1,sigma,k,uhat)
}


results = tibble(a=a_vector, delta = delta_vector)
p = ggplot(results, aes(x=a,y=delta)) + geom_point(color = "red") + geom_line() + geom_hline(yintercept = 0)

print(p)

# Find x-intercept
a_not_zero = a_vector[2:n]
delta_not_zero = delta_vector[2:n]
ind = which.min(abs(delta_not_zero))
a_star = a_not_zero[ind]
delta_star = delta_not_zero[ind]
print(paste("Delta is",delta_star,"at a=",a_star))
```
* a_predicted is probably around 0.00205

Since a_observed was at 0.005 and P(increase) didn't level off until around 0.01, concentrate on a between 0.001 and 0.015
```{r}
a_seq = c(seq(0.001,0.015,length.out=100), seq(0.02,1.0,length.out=50))
```

### Files

* text file: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.05_run/slurm_text/uhat5_april11_full_a_run.txt`
* SLURM main script: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.05_run/slurm_main/uhat5_april11_main.sh`
  + **Submitted batch job 4277417**
* SLURM merge script: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.05_run/slurm_merge/`
  + On the cluster, this is at: `/home/ikk23/underdom/merge_scripts/uhat5_april11_merge.sh`
    * Creates `/home/ikk23/underdom/out_u5/uhat5_april11_full_a_run.csv`
* Raw csv is now at: `/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.05_run/csv_raw/uhat5_april11_full_a_run.csv`