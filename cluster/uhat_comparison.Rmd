---
title: "uhat_comparison"
author: "Isabel Kim"
date: "3/30/2022"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## u_hat = 5 vs u_hat = 10 vs u_hat = 20 - a vs P(increase) on the same axes

```{r}
library(tidyverse)
source("/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/plotting_functions.R")

summary_u10 = read_csv("/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.1_run/csvs/uhat_10_more_replicate_summary.csv")
obs_vs_pred_u10 = get_a_pred_and_a_obs(summary_u10)

summary_u20 = read_csv("/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.2_run/csvs/uhat_0.2_more_replicate_summary.csv")
obs_vs_pred_u20 = get_a_pred_and_a_obs(summary_u20)

summary_u5 = read_csv("/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/u_hat=0.05_run/csvs/uhat_5_u0.001_to_0.02_summary.csv")
obs_vs_pred_u5 = get_a_pred_and_a_obs(summary_u5)

compiled = rbind(summary_u5,summary_u10, summary_u20)
compiled$u_hat = as.character(compiled$u_hat)

compiled_plot = ggplot(data = compiled, aes(x = a, y = p_increase, color = u_hat)) +
  geom_line() +
  xlab("a") +
  ylab("P(increase)") +
  xlim(0, 0.05) +
  geom_vline(xintercept = obs_vs_pred_u5$a_pred, color = "coral1") +
  geom_vline(xintercept = obs_vs_pred_u10$a_pred, color = "green") +
  geom_vline(xintercept = obs_vs_pred_u20$a_pred, color = "mediumturquoise") +
  labs(title = paste0("for u_hat = 5,   a_pred is ", round(obs_vs_pred_u5$a_pred, 4),
                      " and a_obs is ", round(obs_vs_pred_u5$a_obs, 4),
                      "\nfor u_hat = 10, a_pred is ", round(obs_vs_pred_u10$a_pred,4), 
                      " and a_obs is ", round(obs_vs_pred_u10$a_obs, 4), 
                      "\nfor u_hat = 20, a_pred is ", round(obs_vs_pred_u20$a_pred,4), 
                      " and a_obs is ", round(obs_vs_pred_u20$a_obs,4)))

#ggsave(filename = "/Users/isabelkim/Desktop/year2/underdominance/reaction-diffusion/cluster/uhat20_vs_uhat10_vs_uhat5.png", plot = compiled_plot)

compiled_plot
```

It makes sense that when the invasion frequency is lower, a smaller release area is required in order for the drive to spread -- this is why the coral line (uhat=5) is behind the green line (uhat=10) and the green line (uhat=10) is behind the blue line (uhat=20). The observed values of a that cause P(increase)=50% are about 0.005-0.01 apart. However, the predicted values of a are way too close. delta should be more sensitive to changes in u_hat.

## a vs delta for different u_hat
```{r}
compiled_delta_plot = ggplot(data = compiled, aes(x = a, y = delta, color = u_hat)) +
  geom_line() +
  xlab("a") +
  ylab("delta = AUC1-AUC0") +
  labs(title = paste0("for u_hat = 5,   a_pred is ", round(obs_vs_pred_u5$a_pred, 4),
                      " and a_obs is ", round(obs_vs_pred_u5$a_obs, 4),
                      "\nfor u_hat = 10, a_pred is ", round(obs_vs_pred_u10$a_pred,4), 
                      " and a_obs is ", round(obs_vs_pred_u10$a_obs, 4), 
                      "\nfor u_hat = 20, a_pred is ", round(obs_vs_pred_u20$a_pred,4), 
                      " and a_obs is ", round(obs_vs_pred_u20$a_obs,4)))

compiled_delta_plot
```

Where they overlap, these curves have very similar shapes, but the P(increase) is always higher when u_hat is lower (makes sense that with a lower invasion frequency, AUC will increase more).